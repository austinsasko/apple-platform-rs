# We can force the use of specific digests.

```
$ rcodesign debug-create-macho exe
assuming default minimum version 11.0.0
writing Mach-O to exe

$ rcodesign sign --digest sha1 exe exe.signed
signing exe to exe.signed
signing exe as a Mach-O binary
inferring default signing settings from Mach-O binary
setting binary identifier to exe
parsing Mach-O
signing Mach-O binary at index 0
binary targets macOS >= 11.0.0 with SDK 11.0.0
creating ad-hoc signature
code directory version: 132096
total signature size: 272 bytes
writing Mach-O to exe.signed

$ rcodesign print-signature-info exe.signed
- path: exe.signed
  file_size: 18434
  file_sha256: 3b16ae104a78943166abfb5e3376f5710c7a6f56bb03b4ade80a4cd2af333dd2
  entity:
    mach_o:
      linkedit_segment_file_start_offset: 16384
      linkedit_segment_file_end_offset: 18434
      signature_file_start_offset: 16386
      signature_file_end_offset: 18434
      signature_linkedit_start_offset: 2
      signature_linkedit_end_offset: 2050
      signature:
        superblob_length: 272
        blob_count: 2
        blobs:
        - slot: CodeDirectory (0)
          magic: fade0c02
          length: 232
          sha1: 5ffc877d935dd5060b3c91f9bf38c27232859e18
          sha256: 2db2c537eaaa67ae9dd5d706da49a362eaa48545f9f6c91675526b7f985fe29e
        - slot: RequirementSet (2)
          magic: fade0c01
          length: 12
          sha1: 3a75f6db058529148e14dd7ea1b4729cc09ec973
          sha256: 987920904eab650e75788c054aa0b0524e6a80bfc71aa32df8d237a61743f986
        code_directory:
          version: '0x20400'
          flags: CodeSignatureFlags(ADHOC)
          identifier: exe
          digest_type: sha1
          platform: 0
          signed_entity_size: 16386
          executable_segment_flags: ExecutableSegmentFlags(MAIN_BINARY)
          code_digests_count: 5
          slot_digests:
          - 'Info (1): 0000000000000000000000000000000000000000'
          - 'RequirementSet (2): 3a75f6db058529148e14dd7ea1b4729cc09ec973'
        entitlements_plist: null
        cms: null

```

```
$ rcodesign debug-create-macho exe
assuming default minimum version 11.0.0
writing Mach-O to exe

$ rcodesign sign --digest sha1 --extra-digest sha256 exe exe.signed
signing exe to exe.signed
signing exe as a Mach-O binary
inferring default signing settings from Mach-O binary
setting binary identifier to exe
parsing Mach-O
signing Mach-O binary at index 0
binary targets macOS >= 11.0.0 with SDK 11.0.0
creating ad-hoc signature
code directory version: 132096
adding alternative code directory using digest Sha256
binary targets macOS >= 11.0.0 with SDK 11.0.0
creating ad-hoc signature
total signature size: 596 bytes
writing Mach-O to exe.signed

$ rcodesign print-signature-info exe.signed
- path: exe.signed
  file_size: 19458
  file_sha256: 5a74aa527987be28c4fd0db3b3a64e0b0792f7acc4e9f8cf516b12ee24c9ab70
  entity:
    mach_o:
      linkedit_segment_file_start_offset: 16384
      linkedit_segment_file_end_offset: 19458
      signature_file_start_offset: 16386
      signature_file_end_offset: 19458
      signature_linkedit_start_offset: 2
      signature_linkedit_end_offset: 3074
      signature:
        superblob_length: 596
        blob_count: 3
        blobs:
        - slot: CodeDirectory (0)
          magic: fade0c02
          length: 232
          sha1: fb4c7ce93f0184f843970a1cc26e7d45301d259f
          sha256: 3957de2d564a26889dc459a696f69a8ff0a3e82123cd68164d2ac1931f09d107
        - slot: RequirementSet (2)
          magic: fade0c01
          length: 12
          sha1: 3a75f6db058529148e14dd7ea1b4729cc09ec973
          sha256: 987920904eab650e75788c054aa0b0524e6a80bfc71aa32df8d237a61743f986
        - slot: 'CodeDirectory Alternate #0 (4096)'
          magic: fade0c02
          length: 316
          sha1: 76f73672b9b5819785be84a79e2f8a2c21f68f78
          sha256: 8ea48064fef8e94f03ea4b53f21d1fe2aaa5854d751975ae9f10ab5ef980a94f
        code_directory:
          version: '0x20400'
          flags: CodeSignatureFlags(ADHOC)
          identifier: exe
          digest_type: sha1
          platform: 0
          signed_entity_size: 16386
          executable_segment_flags: ExecutableSegmentFlags(MAIN_BINARY)
          code_digests_count: 5
          slot_digests:
          - 'Info (1): 0000000000000000000000000000000000000000'
          - 'RequirementSet (2): 3a75f6db058529148e14dd7ea1b4729cc09ec973'
        alternative_code_directories:
        - - 'CodeDirectory Alternate #0 (4096)'
          - version: '0x20400'
            flags: CodeSignatureFlags(ADHOC)
            identifier: exe
            digest_type: sha256
            platform: 0
            signed_entity_size: 16386
            executable_segment_flags: ExecutableSegmentFlags(MAIN_BINARY)
            code_digests_count: 5
            slot_digests:
            - 'Info (1): 0000000000000000000000000000000000000000000000000000000000000000'
            - 'RequirementSet (2): 987920904eab650e75788c054aa0b0524e6a80bfc71aa32df8d237a61743f986'
        entitlements_plist: null
        cms: null

```

# Signing a binary supporting old macOS automatically adds SHA-1 digests.

```
$ rcodesign debug-create-macho --minimum-os-version 10.11.3 exe
writing Mach-O to exe

$ rcodesign sign exe exe.signed
signing exe to exe.signed
signing exe as a Mach-O binary
inferring default signing settings from Mach-O binary
activating SHA-1 digests because minimum OS target 10.11.3 is not >=10.11.4
setting binary identifier to exe
parsing Mach-O
signing Mach-O binary at index 0
binary targets macOS >= 10.11.3 with SDK 10.11.3
creating ad-hoc signature
code directory version: 132096
adding alternative code directory using digest Sha256
binary targets macOS >= 10.11.3 with SDK 10.11.3
creating ad-hoc signature
total signature size: 596 bytes
writing Mach-O to exe.signed

$ rcodesign print-signature-info exe.signed
- path: exe.signed
  file_size: 19458
  file_sha256: 6fe9b1f9a598a2a991a5cb4364d16d9838001331237dae65a12e83323731e343
  entity:
    mach_o:
      linkedit_segment_file_start_offset: 16384
      linkedit_segment_file_end_offset: 19458
      signature_file_start_offset: 16386
      signature_file_end_offset: 19458
      signature_linkedit_start_offset: 2
      signature_linkedit_end_offset: 3074
      signature:
        superblob_length: 596
        blob_count: 3
        blobs:
        - slot: CodeDirectory (0)
          magic: fade0c02
          length: 232
          sha1: 303f8dc10e404c5b7d58cf5179e22640140a83bc
          sha256: ee5a865de0c7e3314f214cb33c8d034a289d96dcf5ed8af467504d868ca35ee9
        - slot: RequirementSet (2)
          magic: fade0c01
          length: 12
          sha1: 3a75f6db058529148e14dd7ea1b4729cc09ec973
          sha256: 987920904eab650e75788c054aa0b0524e6a80bfc71aa32df8d237a61743f986
        - slot: 'CodeDirectory Alternate #0 (4096)'
          magic: fade0c02
          length: 316
          sha1: 331770849dcb2a77d1ad37b8c708e014abdb08fd
          sha256: a7945527635f1fb6db30c2bf447c81c6f86d332ad2c10bd9830b195eaa94d074
        code_directory:
          version: '0x20400'
          flags: CodeSignatureFlags(ADHOC)
          identifier: exe
          digest_type: sha1
          platform: 0
          signed_entity_size: 16386
          executable_segment_flags: ExecutableSegmentFlags(MAIN_BINARY)
          code_digests_count: 5
          slot_digests:
          - 'Info (1): 0000000000000000000000000000000000000000'
          - 'RequirementSet (2): 3a75f6db058529148e14dd7ea1b4729cc09ec973'
        alternative_code_directories:
        - - 'CodeDirectory Alternate #0 (4096)'
          - version: '0x20400'
            flags: CodeSignatureFlags(ADHOC)
            identifier: exe
            digest_type: sha256
            platform: 0
            signed_entity_size: 16386
            executable_segment_flags: ExecutableSegmentFlags(MAIN_BINARY)
            code_digests_count: 5
            slot_digests:
            - 'Info (1): 0000000000000000000000000000000000000000000000000000000000000000'
            - 'RequirementSet (2): 987920904eab650e75788c054aa0b0524e6a80bfc71aa32df8d237a61743f986'
        entitlements_plist: null
        cms: null

```
